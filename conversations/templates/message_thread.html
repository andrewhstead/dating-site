{% extends "base.html" %}

{% block content %}

    <div id="page-header">
        MESSAGES: <a class="standard-link" href="{% url 'view_profile' other_person.id %}">{{ other_person.username }}</a>
    </div>

    <section id="messages">

        <!-- List all the posts in turn. -->
        {% for message in thread_messages %}

            {% if user == message.sender %}

                <div class="sent-message">

                    <img class="sent-message-picture" alt="Profile Picture" src="{{ message.sender.profile_picture.url }}" />

                    <div class="sent-message-text">
                        {{ message.content }}
                    </div>

                    <div class="sent-message-details">
                        Sent: {{ message.created_date|date:'d M y, H:i' }},
                        {% if message.is_read == False %}
                            <strong>
                                Unread
                            </strong>
                        {% else %}
                            Read: {{ message.read_date|date:'d M y, H:i' }}
                        {% endif %}
                    </div>

                </div>

            {% else %}

                <div class="received-message">

                    <img class="received-message-picture" alt="Profile Picture" src="{{ message.sender.profile_picture.url }}" />

                    <div class="received-message-text">
                        {{ message.content }}
                    </div>

                    <div class="received-message-details">
                        Sent: {{ message.created_date|date:'d M y, H:i' }}
                    </div>

                </div>

            {% endif %}

        {% endfor %}

    </section>

    <!-- Form for sending a message to another user. -->
    <form id="default-form" role="form" method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button class="default-button" type="submit">{{ button_text }}</button>
    </form>

{% endblock %}