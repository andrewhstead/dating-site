{% extends "base.html" %}

{% block content %}

    <section id="page-header">
        {% if profile.id == user.id %}
            YOUR PROFILE
        {% else %}
            {{ profile.username }}
        {% endif %}
        <img class="user-flag" src="{{profile.country.flag.url}}" />
        {% if favourite %}
            <img class="profile-icon" alt="Favourited" src="/media/images/icons/star_gold.png" />
        {% endif %}
    </section>

    <section id="profile-header" class="flex-container">
        <div>
            {% if profile.profile_picture %}
                <img class="profile-picture" alt="{{ profile.username }}" src="{{ profile.profile_picture.url }}" />
            {% endif %}
        </div>
        <div>
            {% if profile.intro %}
                {{ profile.intro }}
            {% endif %}
        </div>
    </section>

    <section id="profile-text">
        {% if profile.text %}
            {{ profile.text }}
        {% endif %}
    </section>

    <section class="profile-info" id="location">
        <ul>
            <li>
                <strong>Country:</strong> {{ profile.country }}
            </li>
        </ul>
    </section>

    <section class="profile-info" id="details">
        <ul>
            <li>
                <strong>Age:</strong> {{ age }}
            </li>
            <li>
                <strong>Gender:</strong>
                {% if profile.gender %}
                    {{ profile.gender }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Status:</strong>
                {% if profile.marital_status %}
                    {{ profile.marital_status }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Looking For:</strong>
                {% if profile.looking_for %}
                    {{ profile.looking_for }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Seeking:</strong>
                {% if profile.relationship %}
                    {{ profile.relationship }}
                {% else %}
                    -
                {% endif %}
            </li>
        </ul>
    </section>

    <section class="profile-info" id="appearance">
        <ul>
            <li>
                <strong>Ethnicity:</strong>
                {% if profile.ethnicity %}
                    {{ profile.ethnicity }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Hair Colour:</strong>
                {% if profile.hair %}
                    {{ profile.hair }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Eye Colour:</strong>
                {% if profile.eyes %}
                    {{ profile.eyes }}
                {% else %}
                    -
                {% endif %}
            </li>
        </ul>
    </section>

    <section class="profile-info" id="lifestyle">
        <ul>
            <li>
                <strong>Has Children:</strong>
                {% if profile.has_children %}
                    {{ profile.has_children }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Wants Children:</strong>
                {% if profile.wants_children %}
                    {{ profile.wants_children }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Drinks:</strong>
                {% if profile.drinks %}
                    {{ profile.drinks }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Smokes:</strong>
                {% if profile.smokes %}
                    {{ profile.smokes }}
                {% else %}
                    -
                {% endif %}
            </li>
            <li>
                <strong>Diet:</strong>
                {% if profile.diet %}
                    {{ profile.diet }}
                {% else %}
                    -
                {% endif %}
            </li>
        </ul>
    </section>

    <section id="user-details" class="flex-container">
        <div class="columns">
            <strong>Member since:</strong><br />
            {{ profile.date_joined|date:'d M y, H:i' }}
        </div>
        <div class="columns">
            <strong>Last login:</strong><br />
            {{ profile.last_login|date:'d M y, H:i' }}
        </div>
    </section>

    <!-- If the user is viewing their own profile, link to the editing page. -->
    {% if profile.id == user.id %}
        <div class="full-details">
            <a class="standard-link" href="{% url 'user_profile' %}">[Edit Your Profile]</a>
        </div>
    {% endif %}

    <!-- If the user is viewing another profile, show links to allow them to add as a favourite,
    wave or send a message. -->
    {% if profile.id != user.id %}
        <section id="contact-links" class="flex-container">
            {% if favourite %}
                <div class="contacted-button">
                    Favourited
                </div>
            {% else %}
                <div class="contact-button">
                    <span onclick="confirmationAlert('favourite')">Favourite</span>
                </div>
            {% endif %}
            {% if new_wave %}
                <div class="contact-button">
                    <span onclick="confirmationAlert('wave')">Wave</span>
                </div>
            {% else %}
                <div class="contacted-button">
                    Waved
                </div>
            {% endif %}
            {% if thread_exists %}
                <div class="contact-button">
                    <a class="contact-link" href="{% url 'message_thread' person_1.id person_2.id %}#latest">Messages</a>
                </div>
            {% else %}
                <div class="contact-button">
                    <a class="contact-link" href="{% url 'new_thread' user.id profile.id %}">Message</a>
                </div>
            {% endif %}
        </section>
    {% endif %}

    <!-- JavaScript confirmation before a favourite is added. -->
    <div id="favourite-wrapper" class="popup-wrapper hidden">
        <div id="favourite-alert" class="alert-message hidden">
            <p>Confirmation:</p>
            <p>Favourite {{ profile.username }}?</p>
            <div class="alert-link">
                <a class="standard-link" href="{% url 'favourite_user' profile.id %}">OK</a>
            </div>
            <div class="alert-link" onclick="confirmationAlert('favourite')">
                Cancel
            </div>
        </div>
    </div>

    <!-- JavaScript confirmation before a wave is sent. -->
    <div id="wave-wrapper" class="popup-wrapper hidden">
        <div id="wave-alert" class="alert-message hidden">
            <p>Confirmation:</p>
            <p>Wave at {{ profile.username }}?</p>
            <div class="alert-link">
                <a class="standard-link" href="{% url 'waved_at' profile.id %}">OK</a>
            </div>
            <div class="alert-link" onclick="confirmationAlert('wave')">
                Cancel
            </div>
        </div>
    </div>

{% endblock %}